use native::build_tx::build_tx;
use native::tx_types::Tx;
use native::SEED;
use orchard::circuit::ProvingKey;
use std::fs::File;
use std::io::Write;

pub fn main() {
    let pk = ProvingKey::build();

    let file = File::open("./tx.bin").unwrap();
    let tx: Tx = bincode::deserialize_from(&file).unwrap();

    let mut out = File::create("out.bin").unwrap();
    for s in 0..20u32 {
        let tx_bytes = build_tx(&tx, SEED, s, &pk);
        out.write_all(&tx_bytes).unwrap();
    }
}

/*
{
  "anchor_height": 1988312,
  "expiry_height": 1988365,
  "orchard_anchor": "6f38b2a0a36dcd87628f0b4e6245ee2c2234e9c00f93e53524b43fe991c3d434",
  "spends": [
    {
      "id": 2,
      "diversifier": "10b9958fd82976efe15a11",
      "rseed": "994808f87712a34ee022b40c416e8ad5a2923a0a1e8f4b5ee7fb8c51a241d6a6",
      "rho": "037b4917cc6093af671a7b24986732a2c80b3356af4441d8ea8abd53f468ae23",
      "witness": "014baafc7ceb8862b42a30c4265b05980dfe6f63af451ec0710146ec6061ed1d280019019db777496ff7a36f69112adfb6a102cd92718b9fb94fe658c25435a901766439016325c267e337c43bc0a8c443a6e6cda582c39a20f969f9d474defa4819e2190d019f5e5f7459b96773c4fc299dc6cc1323827abbaf517f9d4e27124a23afb78e2d000142909839e8b6868cb5659286f4370f906acafeca11f48718a0bc2f51a795b3370000000001b57e668adf422bef5c535438d524791671ecbc86558ef222c2564d501faaaa2f0000000110db4dac730031ae00b1b2e032946ef2bbbe7a54fcec7dc2c8a6f500a96ef41500012e114a11f6356358f21e1641fa1bfa8215d2512c869132dc59cb9d37eb355d16000001510e0b04848a873e8d8ade587e5f4d69f86a1e5a7f45fc6ab78f7d01ee3a631201770d61a963ddd93b5dd0e036a9ab3c0a4236bd74d3eac8061aa515ac6f59443c015dd6672db19d546ec24173b56a556d977a5a5dd9ce1c6a5b2d572c61e96b621400000001e2bca6a8d987d668defba89dc082196a922634ed88e065c669e526bb8815ee1b0a310a0496db6af1bad114ed8f0de84e4c003e3f286ee9be455cc4549576e6fe11088f8f846a5b225f5ca4b359c34a1ee43a4be34eb8896d8f87dc0282bf0ff52876d6d6a6372f2cf0503d01ffad6e3e2b011dd56118b5274035bbfe210990400e7f03ac80f7f87dd4ef4e8974d46d81ebb7c56f3c77be2dc6ebb3d50d36f6bd226673fa0cccb647bb6e53fbed966efb36932d88f57e74c5873facfd3e90331835d74091de3c0d443fb0109d21b507fe495e9c1202daa5b49db5dbba856728332970ff6b406c99601cdf992cdf34e66ef7785bb20676db4784ae0a116184fdfa0f84375a63bad0d6786af92c5bc50bb54c9cab654dff2c7a9a0512154881fe9a1374de8cf9ff7475b414cd37994681a825105965efe06a95e823ba59330393a3327971eb4a7730edfd57ee40c04f77ab2efd30f0bbd61f9446ebc3e7f8947e4817010132560698cfc8948e06a66172225d33601a514a9a4563bb57ae7fca432e671b0501860028ab936427d255f029d5bb6c4084bf9e07ceb979c52eaf449671bb2edc000b000001d3de355410e929c2448dca5786b6b468a759112c84913a48be1dc6c291838037015e46a0c6d06b95b3047dc51237d17691920d9fc4a969408f68d54c5944ddc80601538851f5416dbd66bd8d28034fb919abdebfc20330dcf17a92e1616c25dbeb36015ea4a4dc003813d829475136b089f21de36cac80220676bee23bec920b94d73001545c52dfa81a51dcce726ebeac0d7be373e4d4783d686bcfe639a39c4c6036370001f50767d57e6893d133b25b76e679eb3a6ce5176362f3d8e99bad1b6e413fdc180001c9596467f8c28d37d2163b34e4ae0a3381ccb3ac2528fdfd4ce16cbed3ff84264baafc7ceb8862b42a30c4265b05980dfe6f63af451ec0710146ec6061ed1d28"
      "amount": 50000
    },
    {
      "id": 3,
      "diversifier": "10b9958fd82976efe15a11",
      "rseed": "e11750b6af6ce92f55f3007b0d6897b47abdaad459e9cb673551807e2dd6e118",
      "rho": "2f2d9a08178c8384e67b7e0e8c6ac6d3da22ab7e52fa8a7391203fa1f7aefe15",
      "witness": "01db13d2c2007d2b2d49378bd9a2afc734614b273e281f6484ee3c2815a978043000190000010f3fe5459447af89af5f9e7c4d69d3791907d397aaafda663a933aca1943fd1100000000000153feb82319a8d2f8aac7377f0ae06eadbb9845f779e6c8e7f9d68a313d21481600000182a5ef020c29e95feb7c7d0b313c987b47f2975894da1eab91a40b6d747ca91a0000014c5dc37d1b97461b8c8233a4b6bbd67c2fe63a9e37a4c761a893b3003042182a012e114a11f6356358f21e1641fa1bfa8215d2512c869132dc59cb9d37eb355d16000001510e0b04848a873e8d8ade587e5f4d69f86a1e5a7f45fc6ab78f7d01ee3a631201770d61a963ddd93b5dd0e036a9ab3c0a4236bd74d3eac8061aa515ac6f59443c015dd6672db19d546ec24173b56a556d977a5a5dd9ce1c6a5b2d572c61e96b621400000001e2bca6a8d987d668defba89dc082196a922634ed88e065c669e526bb8815ee1b0c5f2b2024643b862a835b77fbbea4a7623ff3187b2a2ff6eea6b918cee5c1a02a4a3e2762286cba1ac6f7b783f30312d033c6b06287f200cbdd41830aeacda40065024627621e1e1f5b7b21c9958bfcb1ea1a87cf4bad531bc84444d0f5348b112f48f6bb9833baa9a459badec954e67fe64ef2686467bb240b7bb1766e0fe314041e6b082d70cf3e6cce31943665490dec60ad8bb606cff768bfc41c6d3dc90c8cf6113b56bf176f8a2d271d4d92670ca1ce22f1e763babcb90ca617b2b9d62f5b0149da4c4519bb9cd221771e3c3b3a27c2777ac92876e49be0adf5fe4a39074a4c68de9675416f955d0efa73f88c06aa9a21e94a4cfc29b2d4124c09a76611ff72beca935682e85c26b990c583e33d122218b789a8848bf38fe5fa9f44d131517069b1ad12202362fe1e65db7f3f080189c41055c6728aa59d1dba3626b90ed46400fa2b0564e926c7a8e2be4c578bc322a53bd527abd82e8949274e90b23cccb56888299049187a6a9613bda8e37cd7952b116a572fe3931a362206a1f634010132560698cfc8948e06a66172225d33601a514a9a4563bb57ae7fca432e671b0501860028ab936427d255f029d5bb6c4084bf9e07ceb979c52eaf449671bb2edc000b000001d3de355410e929c2448dca5786b6b468a759112c84913a48be1dc6c291838037015e46a0c6d06b95b3047dc51237d17691920d9fc4a969408f68d54c5944ddc80601538851f5416dbd66bd8d28034fb919abdebfc20330dcf17a92e1616c25dbeb36015ea4a4dc003813d829475136b089f21de36cac80220676bee23bec920b94d73001545c52dfa81a51dcce726ebeac0d7be373e4d4783d686bcfe639a39c4c6036370001f50767d57e6893d133b25b76e679eb3a6ce5176362f3d8e99bad1b6e413fdc180001c9596467f8c28d37d2163b34e4ae0a3381ccb3ac2528fdfd4ce16cbed3ff8426db13d2c2007d2b2d49378bd9a2afc734614b273e281f6484ee3c2815a9780430"
      "amount": 49000
    }
  ],
  "outputs": [
    {
      "id": 0,
      "orchard": "10b9958fd82976efe15a11372893ff80cdddc401ffeaf3323693e22d901e570f1b0e2d7538437b0ab86e3d",
      "amount": 98000,
      "memo": "53656e742066726f6d205957616c6c6574"
    }
  ]
}

 */
